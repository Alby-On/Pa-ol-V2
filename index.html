<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Solicitudes - Acceso</title>
    <style>
        /* Estilos b谩sicos */
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .container { 
            background: white; 
            padding: 30px; 
            border-radius: 8px; 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); 
            width: 100%; 
            max-width: 450px; 
        }
        h2 { text-align: center; color: #333; }
        h3 { color: #007bff; margin-top: 25px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="text"], input[type="tel"], input[type="email"], input[type="password"], select {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box; 
        }
        button {
            width: 100%;
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
        }
        button:hover { background-color: #0056b3; }
        .toggle-link { text-align: center; margin-top: 15px; }
        .hidden { display: none !important; } 
        /* Estilo para marcar errores de validaci贸n */
        .input-error { border: 2px solid red !important; }
    </style>
</head>
<body>

<div class="container">
    
    <div id="welcome-view">
        <h2> Bienvenido(a)</h2>
        <p>
            Esta es la plataforma de <b>solicitud de materiales e insumos</b> habilitada por 
            el <b>pa帽ol del 谩rea de Electricidad, Automatizaci贸n y Rob贸tica</b>, un espacio dedicado 
            a la gesti贸n y entrega de herramientas, instrumentos de medici贸n, componentes electr贸nicos, 
            insumos y material did谩ctico para el desarrollo de clases y proyectos.
        </p>
        
        <h3>Consideraciones:</h3>
        <ul>
            <li>Todo material facilitado por pa帽ol debe regresar en las mismas condiciones. 
                Informe cualquier falla o incidente a la brevedad.</li>
            <li>Como respaldo f铆sico, los estudiantes deben entregar su <b>TNE</b> o 
                <b>C茅dula de Identidad vigente</b>, perteneciente al mismo alumno que realiza la solicitud.</li>
            <li>Ante dudas o consultas, acercarse con el Director o Coordinador de Carrera.</li>
        </ul>
        
        <button onclick="showLoginRegister()">Ingresar a la Plataforma</button>
    </div>

    <div id="auth-container" class="hidden">

        <div id="login-view">
            <h2> Iniciar Sesi贸n</h2>
            <form id="loginForm">
                <label for="login-email">Email:</label>
                <input type="email" id="login-email" name="Email" required>

                <label for="login-pass">Contrase帽a:</label>
                <input type="password" id="login-pass" name="Pass" required>

                <button type="submit">Iniciar Sesi贸n</button>
            </form>
            
            <p class="toggle-link">
                驴No tienes cuenta? 
                <a href="#" onclick="showRegister()">Reg铆strate aqu铆</a>
            </p>
        </div>

        <hr>
        
        <div id="register-view" class="hidden">
            <h2> Nuevo Registro</h2>
            <form id="registroForm">
                
                <label for="nombre">Nombre Completo:</label>
                <input type="text" id="nombre" name="Nombre" required>

                <label for="rut">RUT:</label>
                <input type="text" id="rut" name="RUT" placeholder="Ej: 12345678-9" required>

                <label for="carrera">Carrera:</label>
                <select id="carrera" name="Carrera" required>
                    <option value="" disabled selected>Selecciona tu carrera</option>
                    <option value="Ingenier铆a El茅ctrica">Ingenier铆a El茅ctrica</option>
                    <option value="T茅cnico de nivel superior en Electricidad Industrial">T茅cnico de nivel superior en Electricidad Industrial</option>
                    <option value="Ingenier铆a en Automatizaci贸n y Rob贸tica">Ingenier铆a en Automatizaci贸n y Rob贸tica</option>
                    <option value="T茅cnico de nivel superior en Automatizaci贸n y Rob贸tica">T茅cnico de nivel superior en Automatizaci贸n y Rob贸tica</option>
                    <option value="Ingenier铆a en Mecatr贸nica">Ingenier铆a en Mecatr贸nica</option>
                    <option value="T茅cnico de nivel superior en Mecatr贸nica">T茅cnico de nivel superior en Mecatr贸nica</option>
                    <option value="rea Mec谩nica">rea Mec谩nica</option>
                    <option value="Otras reas">Otras reas</option>
                </select>

                <label for="telefono">Tel茅fono:</label>
                <input type="tel" id="telefono" name="Telefono" required>

                <label for="email">Email:</label>
                <input type="email" id="email" name="Email" required>

                <label for="pass">Contrase帽a:</label>
                <input type="password" id="pass" name="Pass" required>

                <button type="submit">Registrarme</button>
            </form>
            
            <p class="toggle-link">
                驴Ya tienes cuenta? 
                <a href="#" onclick="showLogin()">Iniciar Sesi贸n</a>
            </p>
        </div>
    </div> 

</div>

<script>
    // --- LGICA DE VALIDACIN DEL RUT ---
    function validarRutFormato(rut) {
        // Elimina espacios y puntos, y convierte a may煤sculas
        rut = rut.replace(/\s+/g, '').replace(/\./g, '').toUpperCase(); 

        // Expresi贸n regular para el formato XX.XXX.XXX-X o X.XXX.XXX-X, sin puntos.
        // Formato: 1 a 8 d铆gitos + guion + d铆gito verificador (0-9 o K)
        // La expresi贸n ^(\d{1,8})-([\dk])$ valida estrictamente el formato DGITOS-DV
        const rutRegex = /^(\d{1,8})-([\dK])$/;

        if (!rutRegex.test(rut)) {
            // El formato es incorrecto
            return false;
        }

        // Si solo se requiere la validaci贸n de formato, retornamos true.
        // Si quisieras validaci贸n matem谩tica del d铆gito verificador, el c贸digo ser铆a mucho m谩s largo.
        return true;
    }

    // --- LGICA DE MANEJO DE VISTAS ---

    function showLoginRegister() {
        document.getElementById('welcome-view').classList.add('hidden');
        document.getElementById('auth-container').classList.remove('hidden');
        showLogin(); 
    }

    function showRegister() {
        document.getElementById('login-view').classList.add('hidden');
        document.getElementById('register-view').classList.remove('hidden');
    }

    function showLogin() {
        document.getElementById('login-view').classList.remove('hidden');
        document.getElementById('register-view').classList.add('hidden');
    }

    // --- MANEJO DEL ENVO DEL FORMULARIO DE REGISTRO ---
    const registroForm = document.getElementById('registroForm');
    
    registroForm.addEventListener('submit', function(e) {
        e.preventDefault(); // Detener el env铆o por defecto

        const rutInput = document.getElementById('rut');
        const rutValue = rutInput.value;

        // 1. Eliminar cualquier clase de error previa
        rutInput.classList.remove('input-error');

        // 2. Ejecutar la validaci贸n de formato
        if (!validarRutFormato(rutValue)) {
            alert('El RUT ingresado es inv谩lido. Por favor, usa el formato: 20500455-6 (sin puntos).');
            rutInput.classList.add('input-error'); // Marcar el campo en rojo
            rutInput.focus();
            return; // Detiene el proceso de env铆o
        }

        // --- AQUI VA LA LGICA DE ENVO AL GOOGLE APPS SCRIPT ---
        // Si llegamos aqu铆, el formato es correcto y podemos enviar los datos.

        alert('隆Formato de RUT correcto! Procediendo con el registro (Falta conectar con Google Sheet)');
        
        // En este punto, deber铆as llamar a tu funci贸n fetch() para Apps Script.
        // Por ahora, solo tenemos la alerta.
    });
</script>

</body>
</html>
